{% extends "base.html" %}

{% block lab %}Лабораторная 8{% endblock %}

{% block main %}
    <h1>База знаний</h1>

    <div style="margin-bottom: 20px;">
        {% if current_user.is_authenticated %}
            <a href="/lab8/create" style="padding: 8px 15px; background-color: #4CAF50; color: white; text-decoration: none; border-radius: 5px;">Создать новую статью</a>
        {% endif %}
    </div>

    <form method="get" action="/lab8/articles/" style="margin-bottom: 30px; padding: 15px; border: 1px solid #ddd; border-radius: 5px; background-color: #f9f9f9;">
        <label for="search_query">Поиск по заголовку:</label>
        <input type="text" id="search_query" name="q" value="{{ search_query }}" size="40" placeholder="Введите слово или фразу">
        <button type="submit" style="padding: 5px 10px;">Найти</button>
        {% if search_query %}
            <a href="/lab8/articles/" style="margin-left: 10px; color: #dc3545;">Сбросить поиск</a>
        {% endif %}
    </form>
    {% if search_results is not none %}
        <h2 style="border-bottom: 2px solid #555; padding-bottom: 5px;">Результаты поиска по запросу "{{ search_query }}"</h2>
        
        {% if search_results %}
            {% set articles_to_render = search_results %}
            {% include 'lab8/render_article_list.html' %} 

        {% else %}
            <p>По запросу "{{ search_query }}" не найдено ни одной статьи.</p>
        {% endif %}
        
        <h2 style="margin-top: 40px; border-bottom: 2px solid #555; padding-bottom: 5px;">Все доступные статьи</h2>
    {% else %}
        <h2 style="border-bottom: 2px solid #555; padding-bottom: 5px;">Все доступные статьи</h2>
    {% endif %}

    {% if articles %}
        {% set articles_to_render = articles %}
        {% include 'lab8/render_article_list.html' %} 
    {% else %}
        <p>На данный момент нет созданных статей.</p>
    {% endif %}
{% endblock %}